<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8" />

  
  <title>Python装饰器</title>

  
  
  <link href="//cdn.jsdelivr.net" rel="dns-prefetch">
  <link href="//cdnjs.cloudflare.com" rel="dns-prefetch">
  
  <link href="//at.alicdn.com" rel="dns-prefetch">
  
  <link href="//fonts.googleapis.com" rel="dns-prefetch">
  <link href="//fonts.gstatic.com" rel="dns-prefetch">
  <link href="///disqus.com" rel="dns-prefetch">
  <link href="//c.disquscdn.com" rel="dns-prefetch">
  
  <link href="//www.google-analytics.com" rel="dns-prefetch">
  <link href="//hm.baidu.com" rel="dns-prefetch">

  

  
  <meta name="author" content="Qi Zhang">
  <meta name="description" content="Python装饰器的常见用法。所谓的装饰器，其实就是通过装饰器函数，来修改原函数的一些功能，使得原函数不需要修改。
">

  
  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@gohugoio">
    <meta name="twitter:title" content="Python装饰器">
    <meta name="twitter:description" content="Python装饰器的常见用法。所谓的装饰器，其实就是通过装饰器函数，来修改原函数的一些功能，使得原函数不需要修改。
">
    <meta name="twitter:image" content="/images/avatar.png">
  

  
  <meta property="og:type" content="article">
  <meta property="og:title" content="Python装饰器">
  <meta property="og:description" content="Python装饰器的常见用法。所谓的装饰器，其实就是通过装饰器函数，来修改原函数的一些功能，使得原函数不需要修改。
">
  <meta property="og:url" content="https://www.wentixiaogege.com/post/py-decorator/">
  <meta property="og:image" content="/images/avatar.png">




<meta name="generator" content="Hugo 0.57.2">


<link rel="canonical" href="https://www.wentixiaogege.com/post/py-decorator/">

<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="format-detection" content="telephone=no,email=no,adress=no">
<meta http-equiv="Cache-Control" content="no-transform">


<meta name="robots" content="index,follow">
<meta name="referrer" content="origin-when-cross-origin">
<meta name="google-site-verification" content="_moDmnnBNVLBN1rzNxyGUGdPHE20YgbmrtzLIbxaWFc">
<meta name="msvalidate.01" content="22596E34341DD1D17D6022C44647E587">





<meta name="theme-color" content="#02b875">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="wentixiaogege">
<meta name="msapplication-tooltip" content="wentixiaogege">
<meta name='msapplication-navbutton-color' content="#02b875">
<meta name="msapplication-TileColor" content="#02b875">
<meta name="msapplication-TileImage" content="/icons/icon-144x144.png">
<link rel="icon" href="https://www.wentixiaogege.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.wentixiaogege.com/icons/icon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.wentixiaogege.com/icons/icon-32x32.png">
<link rel="icon" sizes="192x192" href="https://www.wentixiaogege.com/icons/icon-192x192.png">
<link rel="apple-touch-icon" href="https://www.wentixiaogege.com/icons/icon-152x152.png">
<link rel="manifest" href="https://www.wentixiaogege.com/manifest.json">


<link rel="preload" href="https://www.wentixiaogege.com/styles/main-rendered.min.css" as="style">


<link rel="preload" href="https://fonts.googleapis.com/css?family=Lobster" as="style">
<link rel="preload" href="https://www.wentixiaogege.com/images/avatar.png" as="image">
<link rel="preload" href="https://www.wentixiaogege.com/images/grey-prism.svg" as="image">


<style>
  body {
    background: rgb(244, 243, 241) url('/images/grey-prism.svg') repeat fixed;
  }
</style>
<link rel="stylesheet" href="https://www.wentixiaogege.com/styles/main-rendered.min.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster">



<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.2/dist/medium-zoom.min.js"></script>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video-js.min.css">



  
  
<!--[if lte IE 8]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-ie8@1.1.2/dist/videojs-ie8.min.js"></script>
<![endif]-->

<!--[if lte IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20180112/classList.min.js"></script>
<![endif]-->


</head>
  <body>
    <div class="suspension">
      <a role="button" aria-label="Go to top" title="Go to top" class="to-top is-hide"><span class="icon icon-up" aria-hidden="true"></span></a>
      
        
	<a role="button" aria-label="Go to comments" title="Go to comments" class="to-comment" href="#disqus_thread"><span class="icon icon-comment" aria-hidden="true"></span></a>
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="https://www.wentixiaogege.com/images/avatar.png" alt="Avatar">
  
  <h2 class="title">wentixiaogege</h2>
  
  <p class="subtitle">Getty Images Contributor. I&#39;m not a photographer but a data enthusiast.</p>
  <button class="menu-toggle" type="button" aria-label="Main Menu" aria-expanded="false" tab-index="0">
    <span class="icon icon-menu" aria-hidden="true"></span>
  </button>

  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item
          
          
           is-active">
          <a href="https://www.wentixiaogege.com/">Home</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="https://github.com/wentixiaogege">GitHub</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="https://wentixiaogegefoto.tuchong.com/">Gallery</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="https://www.wentixiaogege.com/tags/">Tags</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="https://www.wentixiaogege.com/links/">Links</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="https://www.wentixiaogege.com/resume/">Resume</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="https://www.wentixiaogege.com/about/">About</a>
        </li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list"><li class="social-item">
          <a href="mailto:hi@wentixiaogege.com" title="Email" aria-label="Email">
            <span class="icon icon-email" aria-hidden="true"></span>
          </a>
        </li><li class="social-item">
          <a href="//github.com/wentixiaogege" rel="me" title="GitHub" aria-label="GitHub">
	    <span class="icon icon-github" aria-hidden="true"></span>
          </a>
        </li><li class="social-item">
          <a href="//www.instagram.com/wentixiaogege" rel="me" title="Instagram" aria-label="Instagram">
            <span class="icon icon-instagram" aria-hidden="true"></span>
          </a>
        </li><li class="social-item">
          <a href="//weibo.com/bother7" rel="me" title="Weibo" aria-label="Weibo">
            <span class="icon icon-weibo" aria-hidden="true"></span>
          </a>
        </li><li class="social-item">
          <a href="https://www.wentixiaogege.com/images/qrcode.jpg" rel="me" title="Wechat" aria-label="Wechat">
            <span class="icon icon-wechat" aria-hidden="true"></span>
          </a>
        </li></ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">Python装饰器</h1>
      <p class="post-meta">@Qi Zhang · Jul 9, 2019 · 5 min read</p>
    </header>
    <article class="post-content"><p>Python装饰器的常见用法。所谓的装饰器，其实就是通过装饰器函数，来修改原函数的一些功能，使得原函数不需要修改。</p>

<p>函数也是对象，可以赋值给变量，可以做为参数，也可以嵌套在另一个函数内。</p>

<p>对于第三种情况，如果在一个函数的内部定义了另一个函数，外部的我们叫他外函数，内部的我们叫他内函数。在一个外函数中定义了一个内函数，内函数里运用了外函数的临时变量，并且外函数的返回值是内函数的引用。这样就构成了一个<strong>闭包</strong>。</p>

<p>一般情况下，在我们认知当中，如果一个函数结束，函数的内部所有东西都会释放掉，还给内存，局部变量都会消失。但是闭包是一种特殊情况，如果外函数在结束的时候发现有自己的临时变量将来会在内部函数中用到，就把这个临时变量绑定给了内部函数，然后自己再结束。</p>

<h2 id="装饰器从0到1">装饰器从0到1</h2>

<blockquote>
<p>Decorators is to modify the behavior of the function through a wrapper so we don’t have to actually modify the function.</p>
</blockquote>

<p>所谓的装饰器，其实就是通过装饰器函数，来修改原函数的一些功能，使得原函数不需要修改。实际工作中，装饰器通常运用在身份认证（登录认证）、日志记录、性能测试、输入合理性检查及缓存等多个领域中。合理使用装饰器，可极大提高程序的可读性及运行效率。</p>

<p>在面向对象（OOP）的设计模式中，decorator被称为装饰模式。OOP的装饰模式需要通过继承和组合来实现，而Python除了能支持OOP的decorator外，直接从语法层次支持decorator。Python的decorator可以用函数实现，也可以用类实现。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator</span>(func):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inner_wrapper</span>():
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;inner_wrapper of decorator&#39;</span>)
        func()
    <span style="color:#66d9ef">return</span> inner_wrapper

<span style="color:#a6e22e">@my_decorator</span> 
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>)

hello()

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">inner_wrapper of decorator
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
my_decorator<span style="color:#f92672">.</span>__name__   
<span style="color:#75715e"># &#39;my_decorator&#39;</span>
hello<span style="color:#f92672">.</span>__name__   
<span style="color:#75715e"># &#39;inner_wrapper&#39;</span></code></pre></div>
<p>这里的<code>@</code>，我们称之为语法糖。<code>@my_decorator</code> 相当于 <code>greet=my_decorator(greet)</code>。</p>

<p>对于需要传参数的函数，可以在在对应的装饰器函数<code>inner_wrapper()</code>上，加上相应的参数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator</span>(func):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inner_wrapper</span>(arg1):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;inner_wrapper of decorator&#39;</span>)
        func(arg1)
    <span style="color:#66d9ef">return</span> inner_wrapper

<span style="color:#a6e22e">@my_decorator</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>(arg1):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>)
    <span style="color:#66d9ef">print</span>(arg1)

hello(<span style="color:#e6db74">&#34;I&#39;m arg1&#34;</span>)

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">inner_wrapper of decorator
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">I&#39;m arg1
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
my_decorator<span style="color:#f92672">.</span>__name__   <span style="color:#75715e"># &#39;my_decorator&#39;</span>
hello<span style="color:#f92672">.</span>__name__   <span style="color:#75715e"># &#39;inner_wrapper&#39;</span></code></pre></div>
<p>但是，假设我们有一个新函数需要两个参数，前面定义的<code>@my_decorator</code>就会不适用。如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a6e22e">@my_decorator</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>(arg1,arg2):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>)
    <span style="color:#66d9ef">print</span>(arg1)
    <span style="color:#66d9ef">print</span>(arg2)</code></pre></div>
<p>我们可以把<code>*args</code>和<code>**kwargs</code>，作为装饰器内部函数<code>inner_wrapper()</code>的参数 ，表示接受任意数量和类型的参数，因此装饰器就可以写成下面的形式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator</span>(func):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inner_wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;inner_wrapper of decorator&#39;</span>)
        func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
    <span style="color:#66d9ef">return</span> inner_wrapper</code></pre></div>
<p>还可以给decorator函数加参数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">loginfo</span>(info, n):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator</span>(func):
        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inner_wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
                <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;&lt;{i}&gt; loginfo: {info}&#39;</span>)
                func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
        <span style="color:#66d9ef">return</span> inner_wrapper
    <span style="color:#66d9ef">return</span> my_decorator

<span style="color:#a6e22e">@loginfo</span>(<span style="color:#e6db74">&#34;NOBUG&#34;</span>, <span style="color:#ae81ff">3</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>(arg1):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>)
    <span style="color:#66d9ef">print</span>(arg1)

hello(<span style="color:#e6db74">&#34;I&#39;m arg1&#34;</span>)

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">&lt;0&gt; loginfo: NOBUG
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">I&#39;m arg1
</span><span style="color:#e6db74">&lt;1&gt; loginfo: NOBUG
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">I&#39;m arg1
</span><span style="color:#e6db74">&lt;2&gt; loginfo: NOBUG
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">I&#39;m arg1
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
my_decorator<span style="color:#f92672">.</span>__name__   <span style="color:#75715e"># &#39;my_decorator&#39;</span>
hello<span style="color:#f92672">.</span>__name__   <span style="color:#75715e"># &#39;inner_wrapper&#39;</span></code></pre></div>
<p>但是经过装饰器装饰之后，<code>hello()</code>函数的元信息被改变，它不再是以前的那个 <code>hello()</code>函数，而是被<code>inner_wrapper()</code>取代了：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hello<span style="color:#f92672">.</span>__name__ <span style="color:#75715e"># &#39;inner_wrapper&#39;</span>

help(hello)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">Help on function inner_wrapper in module __main__:
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">inner_wrapper(*args, **kwargs)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span></code></pre></div>
<p>这个问题很好解决：</p>

<p>内置的装饰器<code>@functools.wrap</code>，它会帮助保留原函数的元信息（也就是将原函数的元信息，拷贝到对应的装饰器函数里）。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator</span>(func):
    <span style="color:#a6e22e">@functools.wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inner_wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;inner_wrapper of my_decorator.&#39;</span>)
        func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
    <span style="color:#66d9ef">return</span> inner_wrapper

<span style="color:#a6e22e">@my_decorator</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>)

hello<span style="color:#f92672">.</span>__name__
<span style="color:#75715e"># &#39;hello&#39;</span></code></pre></div>
<p>上面的例子可以写成：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">loginfo</span>(info,n):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator</span>(func):
        <span style="color:#a6e22e">@functools.wraps</span>(func)
        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inner_wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
                <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;&lt;{i}&gt; loginfo: {info}&#39;</span>)
                func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
        <span style="color:#66d9ef">return</span> inner_wrapper
    <span style="color:#66d9ef">return</span> my_decorator

<span style="color:#a6e22e">@loginfo</span>(<span style="color:#e6db74">&#34;NOBUG&#34;</span>,<span style="color:#ae81ff">3</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>(arg1):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>)
    <span style="color:#66d9ef">print</span>(arg1)

hello(<span style="color:#e6db74">&#34;I&#39;m arg1&#34;</span>)

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">&lt;0&gt; loginfo: NOBUG
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">I&#39;m arg1
</span><span style="color:#e6db74">&lt;1&gt; loginfo: NOBUG
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">I&#39;m arg1
</span><span style="color:#e6db74">&lt;2&gt; loginfo: NOBUG
</span><span style="color:#e6db74">hello world
</span><span style="color:#e6db74">I&#39;m arg1
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
my_decorator<span style="color:#f92672">.</span>__name__   <span style="color:#75715e"># &#39;my_decorator&#39;</span>
hello<span style="color:#f92672">.</span>__name__   <span style="color:#75715e"># &#39;hello&#39;</span></code></pre></div>
<h2 id="用类作为装饰器">用类作为装饰器</h2>

<p>绝大多数装饰器都是基于函数和闭包实现的，但这并非构造装饰器的唯一方式。事实上，Python 对某个对象是否能通过装饰器（ <code>@decorator</code>）形式使用只有一个要求：<strong>decorator 必须是一个“可被调用（callable）的对象</strong>。</p>

<p>函数自然是“可被调用”的对象。但除了函数外，我们也可以让任何一个类（class）变得“可被调用”（callable），只要自定义类的 <code>__call__</code> 方法即可。</p>

<p>因此不仅仅是函数，类也可以做为装饰器来用。但作为装饰器的类需要包含<code>__call__()</code>方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Count</span>:
    <span style="color:#66d9ef">def</span> __init__(self, func):
        self<span style="color:#f92672">.</span>func <span style="color:#f92672">=</span> func
        self<span style="color:#f92672">.</span>num_calls <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        functools<span style="color:#f92672">.</span>update_wrapper(self, func)
        <span style="color:#75715e"># 类似于函数方法中的：@functools.wraps(func)</span>

    <span style="color:#66d9ef">def</span> __call__(self, <span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        self<span style="color:#f92672">.</span>num_calls <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;num of calls is: {}&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>num_calls))
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)

<span style="color:#a6e22e">@Count</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;hello world&#34;</span>)

hello()

<span style="color:#75715e"># # 输出</span>
<span style="color:#75715e"># num of calls is: 1</span>
<span style="color:#75715e"># hello world</span>

hello()

<span style="color:#75715e"># # 输出</span>
<span style="color:#75715e"># num of calls is: 2</span>
<span style="color:#75715e"># hello world</span>

hello()

<span style="color:#75715e"># # 输出</span>
<span style="color:#75715e"># num of calls is: 3</span>
<span style="color:#75715e"># hello world</span>

hello<span style="color:#f92672">.</span>__name__
<span style="color:#75715e"># &#39;hello&#39;</span></code></pre></div>
<p>通过名为<code>__call__</code>的特殊方法，可以使得类的实例能像python普通函数一样被调用：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Count</span>:
    <span style="color:#66d9ef">def</span> __init__(self, num_calls<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>):
        self<span style="color:#f92672">.</span>num_calls <span style="color:#f92672">=</span> num_calls

    <span style="color:#66d9ef">def</span> __call__(self):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;num of calls is: {}&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>num_calls))

a <span style="color:#f92672">=</span> Count(<span style="color:#ae81ff">666</span>)
a()

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">num of calls is: 666
</span><span style="color:#e6db74">&#34;&#34;&#34;</span></code></pre></div>
<h2 id="装饰器的嵌套使用">装饰器的嵌套使用</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator1</span>(func):
    <span style="color:#a6e22e">@functools.wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;execute decorator1&#39;</span>)
        func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
    <span style="color:#66d9ef">return</span> wrapper

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator2</span>(func):
    <span style="color:#a6e22e">@functools.wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;execute decorator2&#39;</span>)
        func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
    <span style="color:#66d9ef">return</span> wrapper

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_decorator3</span>(func):
    <span style="color:#a6e22e">@functools.wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;execute decorator3&#39;</span>)
        func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
    <span style="color:#66d9ef">return</span> wrapper

<span style="color:#a6e22e">@my_decorator1</span>
<span style="color:#a6e22e">@my_decorator2</span>
<span style="color:#a6e22e">@my_decorator3</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>(message):
    <span style="color:#66d9ef">print</span>(message)
<span style="color:#75715e"># 类似于调用：decorator1(decorator2(decorator3(func)))</span>

hello(<span style="color:#e6db74">&#39;hello world&#39;</span>)
hello<span style="color:#f92672">.</span>__name__

<span style="color:#75715e"># 输出</span>
<span style="color:#75715e"># execute decorator1</span>
<span style="color:#75715e"># execute decorator2</span>
<span style="color:#75715e"># execute decorator3</span>
<span style="color:#75715e"># hello world</span>
<span style="color:#75715e"># &#39;hello&#39;</span></code></pre></div>
<h2 id="装饰器的一些常见用途">装饰器的一些常见用途</h2>

<h4 id="1-记录函数运行时间-日志">1. 记录函数运行时间(日志)</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> time
<span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">log_execution_time</span>(func):
    <span style="color:#a6e22e">@functools.wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>perf_counter()
        res <span style="color:#f92672">=</span> func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
        end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>perf_counter()
        <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;{func.__name__} took {(end - start) * 1000} ms&#39;</span>)
        <span style="color:#66d9ef">return</span> res
    <span style="color:#66d9ef">return</span> wrapper
    
<span style="color:#a6e22e">@log_execution_time</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculator</span>():
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1000000</span>):
        i <span style="color:#f92672">=</span> i<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">6</span>)
    <span style="color:#66d9ef">return</span> i

calculator()
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">calculator took 109.1254340026353 ms
</span><span style="color:#e6db74">48525172657.38456
</span><span style="color:#e6db74">&#34;&#34;&#34;</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">log</span>(func):
    <span style="color:#a6e22e">@functools.wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;call {func.__name__}():&#39;</span>)
        <span style="color:#66d9ef">return</span> func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
    <span style="color:#66d9ef">return</span> wrapper

<span style="color:#a6e22e">@log</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">now</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;2019-3-25&#39;</span>)
    
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">logger</span>(text):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decorator</span>(func):
        <span style="color:#a6e22e">@functools.wraps</span>(func)
        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
            <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;{text} {func.__name__}():&#39;</span>)
            <span style="color:#66d9ef">return</span> func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
        <span style="color:#66d9ef">return</span> wrapper
    <span style="color:#66d9ef">return</span> decorator

<span style="color:#a6e22e">@logger</span>(<span style="color:#e6db74">&#39;DEBUG&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">today</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;2019-3-25&#39;</span>)

now()
<span style="color:#75715e"># call now():</span>
<span style="color:#75715e"># 2019-3-25</span>
today()
<span style="color:#75715e"># DEBUG today():</span>
<span style="color:#75715e"># 2019-3-25</span>
today<span style="color:#f92672">.</span>__name__
<span style="color:#75715e"># today</span></code></pre></div>
<h4 id="2-登录验证">2. 登录验证</h4>

<p>有些网页的权限是需要登录后才有的。可以写一个装饰器函数验证用户是否登录，而不需要重复写登录验证的逻辑。</p>

<h4 id="3-输入合理性检查">3. 输入合理性检查</h4>

<p>对于一些需要做合理性检验的地方，可以抽象出合理性检验的逻辑，封装为装饰器函数，实现复用。例如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">validate_summary</span>(func):
      <span style="color:#a6e22e">@functools.wraps</span>(func)
       <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
           data <span style="color:#f92672">=</span> func(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
           <span style="color:#66d9ef">if</span> len(data[<span style="color:#e6db74">&#34;summary&#34;</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">80</span>:
               <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#34;Summary too long&#34;</span>)
           <span style="color:#66d9ef">return</span> data
       <span style="color:#66d9ef">return</span> wrapper

   <span style="color:#a6e22e">@validate_summary</span>
   <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fetch_customer_data</span>():
       <span style="color:#75715e"># ...</span>

   <span style="color:#a6e22e">@validate_summary</span>
   <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">query_orders</span>(criteria):
       <span style="color:#75715e"># ...</span>

   <span style="color:#a6e22e">@validate_summary</span>
   <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_invoice</span>(params):
       <span style="color:#75715e"># ...</span></code></pre></div>
<h4 id="4-缓存">4. 缓存</h4>

<p>LRU cache，在 Python 中的表示形式是<code>@lru_cache</code>，它会缓存进程中的函数参数和结果，当缓存满了以后，会删除 least recenly used 的数据。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> lru_cache

<span style="color:#a6e22e">@lru_cache</span>(maxsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>) <span style="color:#75715e"># default :128</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sum2</span>(a, b):
    <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#34;Invoke func: sum2()&#34;</span>)
    <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#34;Calculating {a} + {b}&#34;</span>)
    <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b

<span style="color:#66d9ef">print</span>(sum2(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====================&#34;</span>)
<span style="color:#66d9ef">print</span>(sum2(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;====================&#34;</span>)
<span style="color:#66d9ef">print</span>(sum2<span style="color:#f92672">.</span>cache_info())
<span style="color:#66d9ef">print</span>(sum2<span style="color:#f92672">.</span>cache_clear())
<span style="color:#66d9ef">print</span>(sum2<span style="color:#f92672">.</span>cache_info())

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">Invoke func: sum2()
</span><span style="color:#e6db74">Calculating 1 + 2
</span><span style="color:#e6db74">3
</span><span style="color:#e6db74">====================
</span><span style="color:#e6db74">3
</span><span style="color:#e6db74">CacheInfo(hits=1, misses=1, maxsize=16, currsize=1)
</span><span style="color:#e6db74">None
</span><span style="color:#e6db74">CacheInfo(hits=0, misses=0, maxsize=16, currsize=0)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span></code></pre></div>
<h4 id="5-类中常用的-staticmethod-和-classmethod">5. 类中常用的<code>@staticmethod</code>和<code>@classmethod</code></h4>

<ul>
<li><code>@classmethod</code> 装饰的类方法</li>
<li><code>@staticmethod</code>装饰的静态方法</li>
<li>不带装饰器的实例方法</li>
</ul>

<p>用<code>@classmethod</code>修饰的方法，第一个参数不是表示实例本身的<code>self</code>，而是表示当前对象的类本身的<code>clf</code>。<code>@staticmethod</code>是把函数嵌入到类中的一种方式，函数就属于类，同时表明函数不需要访问这个类。通过子类的继承覆盖，能更好的组织代码。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span>(object):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">foo</span>(self, x):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;executing foo(</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">,</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#34;</span> <span style="color:#f92672">%</span> (self, x))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;self:&#39;</span>, self)
    <span style="color:#a6e22e">@classmethod</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">class_foo</span>(cls, x):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;executing class_foo(</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">,</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#34;</span> <span style="color:#f92672">%</span> (cls, x))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;cls:&#39;</span>, cls)
    <span style="color:#a6e22e">@staticmethod</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">static_foo</span>(x):
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;executing static_foo(</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#34;</span> <span style="color:#f92672">%</span> x)    

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    a <span style="color:#f92672">=</span> A()
    <span style="color:#75715e"># foo方法绑定对象A的实例，class_foo方法绑定对象A，static_foo没有参数绑定。</span>
    <span style="color:#66d9ef">print</span>(a<span style="color:#f92672">.</span>foo)
    <span style="color:#75715e"># &lt;bound method A.foo of &lt;__main__.A object at 0x0278B170&gt;&gt;</span>
    <span style="color:#66d9ef">print</span>(a<span style="color:#f92672">.</span>class_foo)
    <span style="color:#75715e"># &lt;bound method A.class_foo of &lt;class &#39;__main__.A&#39;&gt;&gt;</span>
    <span style="color:#66d9ef">print</span>(a<span style="color:#f92672">.</span>static_foo)
    <span style="color:#75715e"># &lt;function A.static_foo at 0x02780390&gt;</span></code></pre></div>
<p>普通的类方法<code>foo()</code>需要通过<code>self</code>参数隐式的传递当前类对象的实例。 <code>@classmethod</code>修饰的方法<code>class_foo()</code>需要通过<code>cls</code>参数传递当前类对象。<code>@staticmethod</code>修饰的方法定义与普通函数是一样的。</p>

<p><code>self</code>和<code>cls</code>的区别不是强制的，只是PEP8中一种编程风格。<code>self</code>通常用作实例方法的第一参数，<code>cls</code>通常用作类方法的第一参数。即通常用<code>self</code>来传递当前类对象的实例，<code>cls</code>传递当前类对象。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># foo可通过实例a调用，类对像A直接调用会参数错误。</span>
a<span style="color:#f92672">.</span>foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing foo(&lt;__main__.A object at 0x0278B170&gt;,1)
</span><span style="color:#e6db74">self: &lt;__main__.A object at 0x0278B170&gt;
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
A<span style="color:#f92672">.</span>foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">Traceback (most recent call last):
</span><span style="color:#e6db74">  File &#34;&lt;stdin&gt;&#34;, line 1, in &lt;module&gt;
</span><span style="color:#e6db74">TypeError: foo() missing 1 required positional argument: &#39;x&#39;
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#75715e"># 但foo如下方式可以使用正常，显式的传递实例参数a。</span>
A<span style="color:#f92672">.</span>foo(a, <span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing foo(&lt;__main__.A object at 0x0278B170&gt;,1)
</span><span style="color:#e6db74">self: &lt;__main__.A object at 0x0278B170&gt;
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#75715e"># class_foo通过类对象或对象实例调用。</span>
A<span style="color:#f92672">.</span>class_foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing class_foo(&lt;class &#39;__main__.A&#39;&gt;,1)
</span><span style="color:#e6db74">cls: &lt;class &#39;__main__.A&#39;&gt;
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
a<span style="color:#f92672">.</span>class_foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing class_foo(&lt;class &#39;__main__.A&#39;&gt;,1)
</span><span style="color:#e6db74">cls: &lt;class &#39;__main__.A&#39;&gt;
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
a<span style="color:#f92672">.</span>class_foo(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> A<span style="color:#f92672">.</span>class_foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing class_foo(&lt;class &#39;__main__.A&#39;&gt;,1)
</span><span style="color:#e6db74">cls: &lt;class &#39;__main__.A&#39;&gt;
</span><span style="color:#e6db74">executing class_foo(&lt;class &#39;__main__.A&#39;&gt;,1)
</span><span style="color:#e6db74">cls: &lt;class &#39;__main__.A&#39;&gt;
</span><span style="color:#e6db74">True
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#75715e"># static_foo通过类对象或对象实例调用。</span>
A<span style="color:#f92672">.</span>static_foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing static_foo(1)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
a<span style="color:#f92672">.</span>static_foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing static_foo(1)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
a<span style="color:#f92672">.</span>static_foo(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> A<span style="color:#f92672">.</span>static_foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing static_foo(1)
</span><span style="color:#e6db74">executing static_foo(1)
</span><span style="color:#e6db74">True
</span><span style="color:#e6db74">&#34;&#34;&#34;</span></code></pre></div>
<p>继承与覆盖普通类函数是一样的。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">B</span>(A):
    <span style="color:#66d9ef">pass</span>
b <span style="color:#f92672">=</span> B()
b<span style="color:#f92672">.</span>foo(<span style="color:#ae81ff">1</span>)
b<span style="color:#f92672">.</span>class_foo(<span style="color:#ae81ff">1</span>)
b<span style="color:#f92672">.</span>static_foo(<span style="color:#ae81ff">1</span>)
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">executing foo(&lt;__main__.B object at 0x007027D0&gt;,1)
</span><span style="color:#e6db74">self: &lt;__main__.B object at 0x007027D0&gt;
</span><span style="color:#e6db74">executing class_foo(&lt;class &#39;__main__.B&#39;&gt;,1)
</span><span style="color:#e6db74">cls: &lt;class &#39;__main__.B&#39;&gt;
</span><span style="color:#e6db74">executing static_foo(1)
</span><span style="color:#e6db74">&#34;&#34;&#34;</span></code></pre></div>
<h2 id="reference">REFERENCE</h2>

<ul>
<li><a href="https://www.oreilly.com/ideas/5-reasons-you-need-to-learn-to-write-python-decorators">5 reasons you need to learn to write Python decorators</a></li>
<li><a href="https://stackoverflow.com/questions/12179271/meaning-of-classmethod-and-staticmethod-for-beginner">Meaning of @classmethod and @staticmethod for beginner?</a></li>
<li><a href="https://stackoverflow.com/questions/136097/what-is-the-difference-between-staticmethod-and-classmethod?rq=1">staticmethod-and-classmethod</a></li>
<li><a href="https://www.zhihu.com/question/20021164/answer/537385841">Python 中的 classmethod 和 staticmethod 有什么具体用途？</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/28010894">正确理解Python中的 @staticmethod@classmethod方法</a></li>
<li><a href="https://github.com/piglei/one-python-craftsman/blob/master/zh_CN/8-tips-on-decorators.md">Python 工匠：使用装饰器的技巧</a></li>
<li><a href="https://pouannes.github.io/blog/decorators/">Finally understanding decorators in Python</a></li>
</ul></article>
    <footer class="post-footer">
      
      <ul class="post-tags">
        
          <li><a href="https://www.wentixiaogege.com/tags/python"><span class="tag">Python</span></a></li>
        
          <li><a href="https://www.wentixiaogege.com/tags/%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="tag">装饰器</span></a></li>
        
      </ul>
      
      <p class="post-copyright">
        © This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License，please give source if you wish to quote or reproduce.This post was published <strong>343</strong> days ago, content in the post may be inaccurate, even wrong now, please take risk yourself.
      </p>
    </footer>
    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "orion-4" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    
  </section>
  
<footer class="site-footer">
  <p>© 2019-2020 wentixiaogege</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank" rel="noopener">Nuo</a>.</p>
  
</footer>


<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@15.0.0/dist/smooth-scroll.min.js"></script>



<script async src="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video.min.js"></script>




<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    },
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>



<script src="https://www.wentixiaogege.com/scripts/index.min.js"></script>

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('\/service-worker.js').then(function() {
      console.log('[ServiceWorker] Registered');
    });
  }
</script>




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-XXXXXXXX-X', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>





<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5713bba443e20a46d066ca93c131f795";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>



  </body>
</html>
